# API —Å–ø–∏—Å–∫–æ–≤ –ø–æ–∫—É–ø–æ–∫

–î–æ–∫—É–º–µ–Ω—Ç –æ–ø–∏—Å—ã–≤–∞–µ—Ç, –∫–∞–∫ –º–æ–±–∏–ª—å–Ω—ã–π –∫–ª–∏–µ–Ω—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç —Å–æ —Å–ø–∏—Å–∫–∞–º–∏ –ø–æ–∫—É–ø–æ–∫ –∏ –ø—É–Ω–∫—Ç–∞–º–∏, –∏ –∫–∞–∫–∏–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã –æ–∂–∏–¥–∞–µ—Ç –æ—Ç Laravel API. –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ **offline-first** —Å –æ—á–µ—Ä–µ–¥—å—é —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏.

## 1. –û–±—â–∞—è –º–æ–¥–µ–ª—å –¥–∞–Ω–Ω—ã—Ö

### 1.1. –õ–æ–∫–∞–ª—å–Ω—ã–µ ID vs UUID —Å–µ—Ä–≤–µ—Ä–∞

–ö–ª–∏–µ–Ω—Ç —Ä–∞–∑–ª–∏—á–∞–µ—Ç:

- `id` ‚Äî –ª–æ–∫–∞–ª—å–Ω—ã–π ID —Å—É—â–Ω–æ—Å—Ç–∏ (
  - –¥–ª—è –Ω–æ–≤—ã—Ö —Å–ø–∏—Å–∫–æ–≤/–ø—É–Ω–∫—Ç–æ–≤ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –∫–∞–∫ `local_<timestamp>_<random>`;
  - –ø–æ—Å–ª–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –º–æ–∂–µ—Ç —Å–æ–≤–ø–∞—Å—Ç—å —Å `serverId`, –µ—Å–ª–∏ —Å–µ—Ä–≤–µ—Ä–Ω—ã–π UUID –ø–æ–¥—Å—Ç–∞–≤–ª–µ–Ω –∏ –≤ `id`).
- `serverId` ‚Äî UUID —Å –±—ç–∫–µ–Ω–¥–∞ (Laravel), –∫–æ—Ç–æ—Ä—ã–π –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤–æ **–≤—Å–µ—Ö HTTP‚Äë–∑–∞–ø—Ä–æ—Å–∞—Ö**.

–ü—Ä–∞–≤–∏–ª–∞:

- –í –ø—É—Ç—è—Ö `/shopping-lists/{id}` –∏ `/shopping-lists/{id}/items/{item_id}` –∫–ª–∏–µ–Ω—Ç –≤—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **—Ç–æ–ª—å–∫–æ `serverId`**.
- –õ–æ–∫–∞–ª—å–Ω—ã–µ `local_*` ID –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ —É—Ö–æ–¥—è—Ç –≤ URL.
- –ü–æ–∫–∞ —Å—É—â–Ω–æ—Å—Ç—å –Ω–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω–∞, –æ–Ω–∞ –ø–æ–º–µ—á–µ–Ω–∞ –∫–∞–∫ `syncStatus = 'pending_create'` –∏ —É—á–∞—Å—Ç–≤—É–µ—Ç —Ç–æ–ª—å–∫–æ –≤ –ª–æ–∫–∞–ª—å–Ω—ã—Ö –≤—ã—á–∏—Å–ª–µ–Ω–∏—è—Ö.

### 1.2. –°—Ç–∞—Ç—É—Å—ã —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏

```ts
export type SyncStatus = 'synced' | 'pending_create' | 'pending_update' | 'pending_delete';
```

- `pending_create` ‚Äî –æ–±—ä–µ–∫—Ç —Å–æ–∑–¥–∞–Ω –ª–æ–∫–∞–ª—å–Ω–æ, –Ω–æ –µ—â—ë –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω –Ω–∞ —Å–µ—Ä–≤–µ—Ä.
- `pending_update` ‚Äî –æ–±—ä–µ–∫—Ç –∏–∑–º–µ–Ω—ë–Ω –ª–æ–∫–∞–ª—å–Ω–æ, —Ç—Ä–µ–±—É–µ—Ç—Å—è PATCH/PUT –Ω–∞ —Å–µ—Ä–≤–µ—Ä.
- `pending_delete` ‚Äî –æ–±—ä–µ–∫—Ç –ø–æ–º–µ—á–µ–Ω –Ω–∞ —É–¥–∞–ª–µ–Ω–∏–µ, –Ω—É–∂–µ–Ω DELETE.

–û—á–µ—Ä–µ–¥—å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ —Ö—Ä–∞–Ω–∏—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω–æ –∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è –ø—Ä–∏ `fullSync()` –∏ –ø—Ä–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–∏ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è.

---

## 2. –≠–Ω–¥–ø–æ–∏–Ω—Ç—ã —Å–ø–∏—Å–∫–æ–≤ –ø–æ–∫—É–ø–æ–∫

### 2.1. –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ —Å–ø–∏—Å–∫–∏ –ø–æ–∫—É–ø–æ–∫

`GET /shopping-lists`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:**

- –ü–æ–ª–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –ª–∏—á–Ω—ã—Ö —Å–ø–∏—Å–∫–æ–≤ –ø–æ–∫—É–ø–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ `ShoppingListsSync.fullSync()`.

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ):**

- `status` ‚Äî —Ñ–∏–ª—å—Ç—Ä –ø–æ —Å—Ç–∞—Ç—É—Å—É —Å–ø–∏—Å–∫–∞ (–æ–¥–Ω–æ –∑–Ω–∞—á–µ–Ω–∏–µ –∏–ª–∏ –º–∞—Å—Å–∏–≤).
- `visibility` ‚Äî —Ñ–∏–ª—å—Ç—Ä –ø–æ –≤–∏–¥–∏–º–æ—Å—Ç–∏ (`personal`, `friends`, `public`).

**–û—Ç–≤–µ—Ç 200:**

```json
{
  "data": [
    {
      "id": "uuid",
      "name": "–ù–∞–∑–≤–∞–Ω–∏–µ",
      "description": "–û–ø–∏—Å–∞–Ω–∏–µ",
      "visibility": "personal",
      "is_shared": false,
      "status": "new",
      "avatar": "üõí",
      "owner_id": "uuid",
      "owner_name": "–ò–º—è –≤–ª–∞–¥–µ–ª—å—Ü–∞",
      "owner_avatar": "https://...",
      "participants": [ /* —Å–ø–∏—Å–æ–∫ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤, —Å–º. –Ω–∏–∂–µ */ ],
      "sort_order": "default",
      "deadline_date": null,
      "event_name": null,
      "notifications_enabled": true,
      "items": [
        {
          "id": "uuid",
          "shopping_list_id": "uuid",
          "name": "–ú–æ–ª–æ–∫–æ",
          "image_url": null,
          "quantity": 1,
          "unit": "—à—Ç",
          "priority": null,
          "is_purchased": false,
          "completed_by": null,
          "completed_by_name": null,
          "completed_at": null,
          "assigned_to": null,
          "assigned_to_name": null,
          "event_date": null,
          "note": null,
          "sort_index": 0,
          "created_at": "...",
          "updated_at": "..."
        }
      ],
      "created_at": "...",
      "updated_at": "..."
    }
  ]
}
```

**–ö–∞–∫ –∫–ª–∏–µ–Ω—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –æ—Ç–≤–µ—Ç (`fullSync`):**

1. –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –æ—á–µ—Ä–µ–¥—å –ª–æ–∫–∞–ª—å–Ω—ã—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π (create/update/delete) —á–µ—Ä–µ–∑ –æ—Ç–¥–µ–ª—å–Ω—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã.
2. –í—ã–∑—ã–≤–∞–µ—Ç `GET /shopping-lists`.
3. –ú–∞–ø–ø–∏—Ç –∫–∞–∂–¥—ã–π —ç–ª–µ–º–µ–Ω—Ç `data` –≤ –ª–æ–∫–∞–ª—å–Ω—É—é –º–æ–¥–µ–ª—å `ShoppingListLocal`:
   - `itemsCount = items.length`;
   - `completedCount = items.filter(i => i.is_purchased).length`;
   - —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –∏ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ;
   - –ø–æ–ª–µ `is_shared` –º–∞–ø–ø–∏—Ç—Å—è –≤ `isShared` –∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è —Å–ø–∏—Å–∫–æ–≤ –Ω–∞ –≤–∫–ª–∞–¥–∫–∏ ¬´–ú–æ–∏¬ª –∏ ¬´–°–æ–≤–º–µ—Å—Ç–Ω—ã–µ¬ª.
4. –õ–æ–∫–∞–ª—å–Ω—ã–µ —Å–ø–∏—Å–∫–∏ —Å `syncStatus = 'pending_create'` —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è **–ø–æ–≤–µ—Ä—Ö** –æ—Ç–≤–µ—Ç–∞ —Å–µ—Ä–≤–µ—Ä–∞ (–Ω–µ —Ç–µ—Ä—è—é—Ç—Å—è).

### 2.2. –ü–æ–ª—É—á–∏—Ç—å –æ–¥–∏–Ω —Å–ø–∏—Å–æ–∫ –ø–æ–∫—É–ø–æ–∫

`GET /shopping-lists/{list_id}`

**–û—Ç–≤–µ—Ç 200:** —Ç–æ—Ç –∂–µ —Ñ–æ—Ä–º–∞—Ç, —á—Ç–æ –∏ —ç–ª–µ–º–µ–Ω—Ç –º–∞—Å—Å–∏–≤–∞ –≤ `GET /shopping-lists` (–ø—Ä–∏ –∂–µ–ª–∞–Ω–∏–∏ –º–æ–∂–Ω–æ –±–µ–∑ –≤–ª–æ–∂–µ–Ω–Ω—ã—Ö `items`).

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ –¥–µ—Ç–∞–ª—å–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏—è—Ö (–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ–¥–Ω–æ–≥–æ —Å–ø–∏—Å–∫–∞/—ç–∫—Ä–∞–Ω–∞ –¥–µ—Ç–∞–ª–µ–π). –°–µ–π—á–∞—Å –∫–ª–∏–µ–Ω—Ç –≤ –æ—Å–Ω–æ–≤–Ω–æ–º –æ–ø–∏—Ä–∞–µ—Ç—Å—è –Ω–∞ `GET /shopping-lists`, –Ω–æ —ç–Ω–¥–ø–æ–∏–Ω—Ç —É–¥–æ–±–µ–Ω –¥–ª—è —Ç–æ—á–µ—á–Ω–æ–π –ø–µ—Ä–µ—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏.

### 2.3. –°–æ–∑–¥–∞—Ç—å —Å–ø–∏—Å–æ–∫ –ø–æ–∫—É–ø–æ–∫

`POST /shopping-lists`

**–ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞:**

```json
{
  "name": "–°—É–ø–µ—Ä–º–∞—Ä–∫–µ—Ç",
  "description": "–ü—è—Ç–Ω–∏—á–Ω—ã–µ –ø–æ–∫—É–ø–∫–∏"
}
```

**–û—Ç–≤–µ—Ç 201:**

```json
{
  "data": {
    "id": "uuid",
    "name": "–°—É–ø–µ—Ä–º–∞—Ä–∫–µ—Ç",
    "description": "–ü—è—Ç–Ω–∏—á–Ω—ã–µ –ø–æ–∫—É–ø–∫–∏",
    "visibility": "personal",
    "is_shared": false,
    "status": "new",
    "avatar": null,
    "owner_id": "uuid",
    "owner_name": "–ò–º—è",
    "owner_avatar": "https://...",
    "participants": [],
    "items": [],
    "created_at": "...",
    "updated_at": "..."
  }
}
```

**–ü–æ–≤–µ–¥–µ–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç–∞ (offline-first):**

- –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ —Å–ø–∏—Å–∫–∞ –Ω–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ:
  - —Å–æ–∑–¥–∞—ë—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω—ã–π `ShoppingListLocal` —Å `id = local_*`, `syncStatus = 'pending_create'`;
  - –∑–∞–ø–∏—Å—å –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –≤ –æ—á–µ—Ä–µ–¥—å `shopping_sync_queue` —Å –æ–ø–µ—Ä–∞—Ü–∏–µ–π `create`;
  - –≤ —Ñ–æ–Ω–µ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è `POST /shopping-lists` (–µ—Å–ª–∏ –µ—Å—Ç—å —Å–µ—Ç—å);
  - –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –æ—Ç–≤–µ—Ç–∞:
    - –ª–æ–∫–∞–ª—å–Ω—ã–π –æ–±—ä–µ–∫—Ç –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è: `serverId = response.data.id`, `syncStatus = 'synced'`;
    - –æ–ø–µ—Ä–∞—Ü–∏—è `create` —É–¥–∞–ª—è–µ—Ç—Å—è –∏–∑ –æ—á–µ—Ä–µ–¥–∏.

### 2.4. –û–±–Ω–æ–≤–∏—Ç—å —Å–ø–∏—Å–æ–∫ –ø–æ–∫—É–ø–æ–∫

`PATCH /shopping-lists/{list_id}`

**–ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞:**

```json
{
  "name": "–û–±–Ω–æ–≤–ª—ë–Ω–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ",
  "description": "–û–ø–∏—Å–∞–Ω–∏–µ",
  "visibility": "friends",
  "status": "active",
  "avatar": "üõí"
}
```

**–û—Ç–≤–µ—Ç 200:** –æ–±—ä–µ–∫—Ç —Å–ø–∏—Å–∫–∞ –≤ –∞–∫—Ç—É–∞–ª—å–Ω–æ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏.

**–ü–æ–≤–µ–¥–µ–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç–∞:**

- –ù–∞ —ç–∫—Ä–∞–Ω–µ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:
  - –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å—Ä–∞–∑—É –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –∫ –ª–æ–∫–∞–ª—å–Ω–æ–º—É —Å–ø–∏—Å–∫—É (`optimistic update`), `syncStatus = 'pending_update'` (–µ—Å–ª–∏ –Ω–µ `pending_create`);
  - –≤ –æ—á–µ—Ä–µ–¥—å –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –æ–ø–µ—Ä–∞—Ü–∏—è `update` —Å `entityId = serverId` –∏ –ø–æ–ª—è–º–∏ `updates`.
- –ü—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ –æ—á–µ—Ä–µ–¥–∏:
  - –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è `PATCH /shopping-lists/{serverId}`;
  - –ø—Ä–∏ —É—Å–ø–µ—Ö–µ –ª–æ–∫–∞–ª—å–Ω—ã–π —Å–ø–∏—Å–æ–∫ –º–æ–∂–µ—Ç –±—ã—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –æ–±–Ω–æ–≤–ª—ë–Ω, –∞ –æ–ø–µ—Ä–∞—Ü–∏—è —É–±—Ä–∞–Ω–∞ –∏–∑ –æ—á–µ—Ä–µ–¥–∏.

### 2.5. –£–¥–∞–ª–∏—Ç—å —Å–ø–∏—Å–æ–∫ –ø–æ–∫—É–ø–æ–∫

`DELETE /shopping-lists/{list_id}`

**–ü–æ–≤–µ–¥–µ–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç–∞:**

- –ï—Å–ª–∏ —Å–ø–∏—Å–æ–∫ –µ—â—ë –Ω–µ —Å–æ–∑–¥–∞–Ω –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ (`pending_create`):
  - —É–¥–∞–ª—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –ª–æ–∫–∞–ª—å–Ω–æ, –±–µ–∑ –∑–∞–ø—Ä–æ—Å–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä.
- –ï—Å–ª–∏ —Å–ø–∏—Å–æ–∫ —É–∂–µ –∏–º–µ–µ—Ç `serverId`:
  - –ª–æ–∫–∞–ª—å–Ω–æ –ø–æ–º–µ—á–∞–µ—Ç—Å—è –Ω–∞ —É–¥–∞–ª–µ–Ω–∏–µ (`pending_delete`),
  - –≤ –æ—á–µ—Ä–µ–¥—å –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –æ–ø–µ—Ä–∞—Ü–∏—è `delete` —Å `entityId = serverId`;
  - –ø—Ä–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è `DELETE /shopping-lists/{serverId}` –∏ –ø–æ—Å–ª–µ —É—Å–ø–µ—Ö–∞ —Å–ø–∏—Å–æ–∫ —É–¥–∞–ª—è–µ—Ç—Å—è –∏–∑ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞.

---

## 3. –≠–Ω–¥–ø–æ–∏–Ω—Ç—ã –ø—É–Ω–∫—Ç–æ–≤ —Å–ø–∏—Å–∫–æ–≤

### 3.1. –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ –ø—É–Ω–∫—Ç—ã —Å–ø–∏—Å–∫–∞

`GET /shopping-lists/{list_id}/items`

**–û—Ç–≤–µ—Ç 200:**

```json
{
  "data": [
    {
      "id": "uuid",
      "shopping_list_id": "uuid",
      "name": "–ú–æ–ª–æ–∫–æ",
      "image_url": null,
      "quantity": 1,
      "unit": "—à—Ç",
      "priority": null,
      "is_purchased": false,
      "completed_by": null,
      "completed_by_name": null,
      "completed_at": null,
      "assigned_to": null,
      "assigned_to_name": null,
      "event_date": null,
      "note": null,
      "sort_index": 0,
      "created_at": "...",
      "updated_at": "..."
    }
  ]
}
```

–ö–ª–∏–µ–Ω—Ç –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —ç—Ç–æ—Ç —ç–Ω–¥–ø–æ–∏–Ω—Ç –¥–ª—è –¥–µ—Ç–∞–ª—å–Ω–æ–π —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –ø—É–Ω–∫—Ç–æ–≤ –æ–¥–Ω–æ–≥–æ —Å–ø–∏—Å–∫–∞.

### 3.2. –°–æ–∑–¥–∞—Ç—å –ø—É–Ω–∫—Ç –≤ —Å–ø–∏—Å–∫–µ

`POST /shopping-lists/{list_id}/items`

**–ó–∞–ø—Ä–æ—Å:**

```json
{
  "name": "–•–ª–µ–±",
  "quantity": 2,
  "unit": "—à—Ç"
}
```

**–û—Ç–≤–µ—Ç 201:** –æ–±—ä–µ–∫—Ç –ø—É–Ω–∫—Ç–∞.

**–ü–æ–≤–µ–¥–µ–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç–∞:**

- –õ–æ–∫–∞–ª—å–Ω–æ —Å–æ–∑–¥–∞—ë—Ç—Å—è `ShoppingItemLocal` —Å `id = local_*`, `syncStatus = 'pending_create'`.
- –ü—É–Ω–∫—Ç –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –≤ –æ—á–µ—Ä–µ–¥—å (`entityType = 'item'`, `parentId = listId`).
- –í —Ñ–æ–Ω–µ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è `POST /shopping-lists/{serverListId}/items` (–µ—Å–ª–∏ —É —Å–ø–∏—Å–∫–∞ —É–∂–µ –µ—Å—Ç—å `serverId`).
- –ü—Ä–∏ —É—Å–ø–µ—Ö–µ –ª–æ–∫–∞–ª—å–Ω—ã–π –ø—É–Ω–∫—Ç –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è: `serverId = response.data.id`, `syncStatus = 'synced'`.

–ï—Å–ª–∏ —É —Å–ø–∏—Å–∫–∞ –µ—â—ë –Ω–µ—Ç `serverId`, —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –ø—É–Ω–∫—Ç–∞ –æ—Ç–∫–ª–∞–¥—ã–≤–∞–µ—Ç—Å—è –¥–æ —Å–∏–Ω–∫–∞ —Å–∞–º–æ–≥–æ —Å–ø–∏—Å–∫–∞.

### 3.3. –û–±–Ω–æ–≤–∏—Ç—å –ø—É–Ω–∫—Ç —Å–ø–∏—Å–∫–∞

`PATCH /shopping-lists/{list_id}/items/{item_id}`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:**

- –ò–∑–º–µ–Ω–µ–Ω–∏–µ –Ω–∞–∑–≤–∞–Ω–∏—è, –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞, –µ–¥–∏–Ω–∏—Ü, –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞, –∑–∞–º–µ—Ç–∫–∏ –∏ —Ç.–ø.

–ö–ª–∏–µ–Ω—Ç —Å—Ç–∞–≤–∏—Ç –æ–ø–µ—Ä–∞—Ü–∏—é `update` —Å `entityId = serverItemId` –≤ –æ—á–µ—Ä–µ–¥—å –∏ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ –≤—ã–∑—ã–≤–∞–µ—Ç —ç—Ç–æ—Ç —ç–Ω–¥–ø–æ–∏–Ω—Ç.

### 3.4. –£–¥–∞–ª–∏—Ç—å –ø—É–Ω–∫—Ç

`DELETE /shopping-lists/{list_id}/items/{item_id}`

**–ü–æ–≤–µ–¥–µ–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç–∞:**

- –î–ª—è –Ω–µ—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø—É–Ω–∫—Ç–æ–≤ (`pending_create`) —É–¥–∞–ª–µ–Ω–∏–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —Ç–æ–ª—å–∫–æ –ª–æ–∫–∞–ª—å–Ω–æ.
- –î–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö ‚Äî —Å—Ç–∞–≤–∏—Ç—Å—è –æ–ø–µ—Ä–∞—Ü–∏—è `delete` –∏ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ –æ—á–µ—Ä–µ–¥–∏ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è `DELETE`.

### 3.5. –û—Ç–º–µ—Ç–∏—Ç—å –ø—É–Ω–∫—Ç –∫–∞–∫ –∫—É–ø–ª–µ–Ω–Ω—ã–π/–Ω–µ –∫—É–ø–ª–µ–Ω–Ω—ã–π

`PATCH /shopping-lists/{list_id}/items/{item_id}` —Å –ø–æ–ª–µ–º `is_purchased`.

–ö–ª–∏–µ–Ω—Ç —É–∂–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —ç–Ω–¥–ø–æ–∏–Ω—Ç `toggleShoppingItemPurchased`, –∫–æ—Ç–æ—Ä—ã–π –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç:

```json
{
  "is_purchased": true
}
```

---

## 4. Offline-first –ø–æ–≤–µ–¥–µ–Ω–∏–µ –Ω–∞ —ç–∫—Ä–∞–Ω–µ "–°–ø–∏—Å–∫–∏ –ø–æ–∫—É–ø–æ–∫"

–≠–∫—Ä–∞–Ω `PurchasesScreen` —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –ª–æ–∫–∞–ª—å–Ω—ã–º —Ö—Ä–∞–Ω–∏–ª–∏—â–µ–º:

1. –ü—Ä–∏ –≤—Ö–æ–¥–µ –Ω–∞ —ç–∫—Ä–∞–Ω:
   - —á–∏—Ç–∞–µ—Ç –≤—Å–µ –ª–æ–∫–∞–ª—å–Ω—ã–µ —Å–ø–∏—Å–∫–∏ (`getLocalShoppingLists`);
   - –¥–µ–ª–∏—Ç –∏—Ö –Ω–∞ ¬´–ú–æ–∏¬ª –∏ ¬´–°–æ–≤–º–µ—Å—Ç–Ω—ã–µ¬ª –ø–æ –ø–æ–ª—é `isShared`;
   - –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–ø–∏—Å–∫–∞ –ø–æ–¥–≥—Ä—É–∂–∞–µ—Ç –ª–æ–∫–∞–ª—å–Ω—ã–µ –ø—É–Ω–∫—Ç—ã –∏ –ø–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞–µ—Ç `itemsCount` –∏ `completedCount`.

2. –ü—Ä–∏ pull-to-refresh:
   - –≤—ã–∑—ã–≤–∞–µ—Ç `ShoppingListsSync.fullSync()` (–æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—á–µ—Ä–µ–¥–∏ + –∑–∞–≥—Ä—É–∑–∫–∞ –≤—Å–µ—Ö —Å–ø–∏—Å–∫–æ–≤ –∏ –∏—Ö —Å—Ç–∞—Ç—É—Å–æ–≤);
   - –∑–∞—Ç–µ–º –ø–µ—Ä–µ—á–∏—Ç—ã–≤–∞–µ—Ç –ª–æ–∫–∞–ª—å–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –∏ —Å–Ω–æ–≤–∞ –¥–µ–ª–∏—Ç —Å–ø–∏—Å–∫–∏ –ø–æ `isShared`.

3. –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏/—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏/—É–¥–∞–ª–µ–Ω–∏–∏ —Å–ø–∏—Å–∫–æ–≤ –∏ –ø—É–Ω–∫—Ç–æ–≤:
   - –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å–Ω–∞—á–∞–ª–∞ –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –∫ –ª–æ–∫–∞–ª—å–Ω—ã–º –º–æ–¥–µ–ª—è–º;
   - –æ–ø–µ—Ä–∞—Ü–∏–∏ –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è –≤ –æ—á–µ—Ä–µ–¥—å;
   - –ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ —Å–µ—Ç–∏ –∏/–∏–ª–∏ –ø—Ä–∏ –æ–±—â–µ–π —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ (`fullSync`, –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–µ—Ç–∏) –æ—á–µ—Ä–µ–¥—å –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä.

–¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –µ—Å–ª–∏ —Å–µ—Ç—å –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—Å—ë —Ä–∞–≤–Ω–æ –≤–∏–¥–∏—Ç –∏ –∏–∑–º–µ–Ω—è–µ—Ç —Å–≤–æ–∏ —Å–ø–∏—Å–∫–∏; –ø—Ä–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–∏ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è –≤—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –¥–æ–µ–∑–∂–∞—é—Ç –¥–æ Laravel API —á–µ—Ä–µ–∑ –æ–ø–∏—Å–∞–Ω–Ω—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã.
